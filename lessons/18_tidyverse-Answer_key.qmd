---
title: "Tidyverse data wrangling Answer Key"
author:
  - Will Gammerdinger
date: "2025-07-01"
---

```{r}
#| label: load_libraries_data
#| echo: false
# Load the tidyverse package
library(tidyverse)

# Read in the gprofiler results
functional_GO_results <- read_delim(file = "data/gprofiler_results_Mov10oe.txt", delim = "\t" )

# Filter gprofiler results for "biological processes" domains
bp_oe <- functional_GO_results %>%
  filter(domain == "BP")
```

# Exercise 1

Create a vector of random numbers using the code below:

```{r}
#| label: create_random_numbers_vector
# Create a vector of random numbers
random_numbers <- c(81, 90, 65, 43, 71, 29)
```

Use the pipe (`%>%`) to perform two steps:

  1.  Take the mean of `random_numbers` using the `mean()` function.
  
```{r}
#| label: mean_pipe
# Return the mean of the random_numbers vector
random_numbers %>% 
  mean()
```
  
  2.  Round the output to three digits using the `round()` function.
  
```{r}
#| label: mean_round_pipe
# Return the mean of the random_numbers vector and round to three digits
random_numbers %>% 
  mean() %>% 
  round(digits = 3)
```

# Exercise 2

We would like to perform an additional round of filtering to only keep the most specific GO terms.

1.  For `bp_oe`, use the `filter()` function to only keep those rows where the `relative.depth` is greater than 4.

```{r}
#| label: filter_bp_oe
# Filter bp_oe to keep those rows where the relative.depth is greater than 4
bp_oe %>% 
  filter(relative.depth > 4)
```

2.  Save output to overwrite our `bp_oe` object

```{r}
#| label: reassign_filter_bp_oe
# Filter bp_oe to keep those rows where the relative.depth is greater than 4 and overwrite the bp_oe object
bp_oe <- bp_oe %>% 
  filter(relative.depth > 4)

# Print object after filtering on the relative.depth column 
bp_oe
```


```{r}
#| label: prep_data_for_exercise_3
#| echo: false
# Select columns
bp_oe <- bp_oe %>%
  select(term.id, term.name, p.value, query.size, term.size, overlap.size, intersection)

# Arrange by p.value
bp_oe <- bp_oe %>%
  arrange(p.value)

# Rename term.id and term.name columns
bp_oe <- bp_oe %>% 
  dplyr::rename(GO_id = term.id, 
                GO_term = term.name)
```

# Exercise 3

Rename the `intersection` column to `genes` to reflect the fact that these are the DE genes associated with the GO process.

```{r}
#| label: rename_column
# Rename the interaction column of the bp_oe to be genes
bp_oe <- bp_oe %>% 
  dplyr::rename(genes = intersection)

# Print object after renaming the column
bp_oe
```

```{r}
#| label: prep_data_for_exercise_4
#| echo: false
# Add column for gene_ratio
bp_oe <- bp_oe %>%
  mutate(gene_ratio = overlap.size / query.size)
```

# Exercise 4

Create a column in `bp_oe` called `term_percent` to determine the percent of DE genes associated with the GO term relative to the total number of genes associated with the GO term (`overlap.size` / `term.size`)

```{r}
#| label: add_column_term_percent
# Create term_percent column based on other columns in dataset
bp_oe <- bp_oe %>% 
  mutate(term_percent = overlap.size / term.size)

# Print object after creating the new column
bp_oe
```
