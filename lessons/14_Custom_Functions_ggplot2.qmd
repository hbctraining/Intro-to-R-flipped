---
title: "Custom functions for consistent plots"
description: |
  This lesson introduces participants to creating and applying custom functions in R to ensure consistent formatting across plots. Participants will learn how to bundle preferred theme elements into a reusable function and apply it to their visualizations for cleaner and more uniform results.
author:
  - Mary Piper
  - Meeta Mistry
  - Radhika Khetani
  - Jihe Liu
  - Will Gammerdinger
  - Noor Sohail
date: "2025-05-30"
categories: 
  - R Programming
  - Data visualization
  - Reproducible Research
keywords:
  - R
  - ggplot2
  - custom themes
  - plotting functions
license: "CC-BY-4.0"
editor_options: 
  markdown: 
    wrap: 72
---

Approximate time: 20 minutes

```{r}
#| label: load_libraries_data
#| echo: false
#| eval: true
# Load ggplot2
library(ggplot2)

# Load data
load("data/new_metadata.RData")
```

## Learning Objectives 

- Apply the custom function to generate consistent plots.

## Consistent formatting using custom functions

When publishing, it is helpful to ensure all plots have similar formatting. To do this we can create a custom function with our preferences for the theme. Remember the structure of a function is:

```{r}
#| label: function_example
#| eval: false
# DO NOT RUN
name_of_function <- function(arguments) {
    statements or code that does something
}
```

Now, let's suppose we always wanted our theme to include the following:

```{r}
#| label: themes_to_put_into_person_theme_function
#| eval: false
# DO NOT RUN
# Themes we will like to include
theme_bw() +
theme(axis.title=element_text(size=rel(1.5))) +
theme(plot.title=element_text(size=rel(1.5), hjust=0.5))
```

::: {.callout-note}
You can also combine multiple arguments within the same theme() function:

```{r}
#| label: combining_theme_arguments
#| eval: false
# DO NOT RUN
# You can combine all of the theme layers into a single layer
theme_bw() +
theme(axis.title=element_text(size=rel(1.5)), 
      plot.title=element_text(size=rel(1.5), hjust=0.5))
```
:::

If there is nothing that we want to change when we run this, then we do not need to specify any arguments. Creating the function is simple; we can just put the code inside the `{}`:

```{r}
#| label: create_personal_theme
# Create personal theme function for figures
personal_theme <- function(){
  theme_bw() +
  theme(axis.title=element_text(size=rel(1.5))) +
  theme(plot.title=element_text(size=rel(1.5), hjust=0.5))
}
```

Now to run our personal theme with any plot, we can use this function in place of the lines of `theme()` code:

```{r}
#| label: apply_personal_theme
# Apply personal theme to figure
ggplot(new_metadata) +
  geom_point(aes(x=age_in_days, y=samplemeans, color=genotype, shape=celltype), size=rel(3.0)) +
  xlab("Age (days)") +
  ylab("Mean expression") +
  ggtitle("Expression with Age") +
  personal_theme()
```
