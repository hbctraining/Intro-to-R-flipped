---
title: "Day 4 Activities"
author: "Mary Piper, Meeta Mistry, Radhika Khetani"
date: "Wednesday, December 4, 2019"
---

# Exercises

```{r}
library(tidyverse)
animals <- read.csv("../data/animals.csv", row.names=1)
```

1.  Change the `animals` data frame to a tibble called `animals_tb`. Save the row names to a column called `animal_names` before turning it into a tibble.

<img src="../../img/animals_tb_unordered.png" width="400"/>

```{r}
animals_tb <- animals %>%
        rownames_to_column(var = "animal_names") %>%
        as_tibble()
animals_tb
```

2.  Use ggplot2 to plot the animal names (x-axis) versus the speed of the animal (y-axis) in `animals_tb` using a scatterplot. Customize the plot to display as shown below.

<img src="../../img/animals_unordered_ggplot2.png" width="425"/>

```{r}
ggplot(animals_tb) +
        geom_point(aes(x = animal_names, y = speed), color = "purple") +
        theme_bw() +
        ggtitle("Speed Comparisons Between Animals") + 
        ylab("Speed (km/h)") +
        xlab("Animal") +
        theme(plot.title=element_text(hjust=0.5))
```

3.  We decide that our plot would look better with the animal names ordered from slowest to fastest. Using the `animals_tb` tibble, reorder the animals on the x-axis to start with the slowest animal on the left-hand side of the plot to the fastest animal on the right-hand side of the plot by completing the following steps:

**a.** Use the `arrange()` function to order the rows by speed from slowest to fastest. Then use the `pull()` function to extract the `animal_names` column as a vector of character values. Save the new variable as `names_ordered_by_speed`.

```{r}
names_ordered_by_speed <- animals_tb %>% arrange(speed) %>% pull(animal_names)
names_ordered_by_speed
```

**b.** Turn the `animal_names` column of `animals_tb` into a factor and specify the levels as `names_ordered_by_speed` from slowest to fastest (output in part a). Note: this step is crucial, because ggplot2 uses `factor` as plotting order, instead of the order we observe in data frame.

```{r}
animals_tb$animal_names <- factor(animals_tb$animal_names, 
                                  levels = names_ordered_by_speed)
animals_tb$animal_names
```

**c.** Re-plot the scatterplot with the animal names in order from slowest to fastest.

<img src="../../img/animals_ordered_ggplot2.png" width="425"/>

```{r}
ggplot(animals_tb) +
        geom_point(aes(x = animal_names, y = speed), color = "purple") +
        theme_bw() +
        ggtitle("Speed Comparisons Between Animals") + 
        ylab("Speed (km/h)") +
        xlab("Animal") +
        theme(plot.title=element_text(hjust=0.5))
```

::: callout-note
If you are interested in exploring other ways to reorder a variable in ggplot2, refer to this [post](https://www.r-graph-gallery.com/267-reorder-a-variable-in-ggplot2.html).
:::

4.  Save the plot as a PDF called `animals_by_speed_scatterplot.pdf` to the `results` folder.

```{r}
ggplot(animals_tb) +
        geom_point(aes(x = animal_names, y = speed), color = "purple") +
        theme_bw() +
        ggtitle("Speed Comparisons Between Animals") + 
        ylab("Speed (km/h)") +
        xlab("Animal") +
        theme(plot.title=element_text(hjust=0.5))
ggsave("../figures/animals_by_speed_scatterplot.pdf")
```

5.  Use the functions from the `dplyr` package to perform the following tasks:

**a.** Extract the rows of `animals_tb` tibble with color of gray or tan, order the rows based from slowest to fastest speed, and save to a variable called `animals_gray_tan`.

<img src="../../img/animals_tb_ordered.png" width="300"/>

```{r}
animals_gray_tan <- animals_tb %>% 
        filter(color == "Gray" | color == "Tan") %>%
        arrange(speed)
animals_gray_tan
```

**b.** Save `animals_gray_tan` as a comma-separated value file called `animals_tb_ordered.csv` to the `results` folder.

```{r}
#| eval: false
write.csv(animals_gray_tan,
          file = "../results/animals_tb_ordered.csv",
          quote = FALSE)
```
